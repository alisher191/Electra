import{e as a,d as p,g as u}from"./chunk-b247637b.js";import{c as R,i as A}from"./chunk-e33f88ff.js";import{J as y}from"./chunk-e8d35fff.js";import{a as S,r as f,g as C}from"./chunk-539dc9f8.js";const _={GROUP:"Group",EXCHANGE:"Exchange",PAY:"Pay",AML:"AML",WALLET:"Wallet",EXCHANGE_V3:"Exchange-V3"};async function h(){return await a().get("/order/last/")}async function T(){return await a().get("/cashe/currencies-test/")}async function w(e){return await a().get("/cashe/operations/detail/"+encodeURI(e))}const g={4:{text:"payment_is_overdue",status:"fail",description:"order_not_completed"},7:{text:"",status:"success",description:"order_completed_successfully"},8:{text:"order_canceled_by_client",status:"fail",description:"order_not_completed"},9:{text:"order_canceled_by_admin",status:"fail",description:"order_not_completed"},14:{text:"payment_is_overdue",status:"fail",description:"order_not_completed"},16:{text:"your_requisites_declined",status:"fail",description:"order_not_completed"},17:{text:"your_requisites_declined",status:"fail",description:"order_not_completed"},18:{text:"fail_order",status:"fail",description:"order_not_completed"},19:{text:"photo_doesnt_match_requirements",status:"fail",description:"order_not_completed"},21:{text:"",status:"success",description:"order_completed_successfully"},22:{text:"",status:"success",description:"order_completed_successfully"},23:{text:"",status:"success",description:"order_completed_successfully"},30:{text:"your_requisites_declined",status:"fail",description:"order_not_completed"},34:{text:"chargeback_for_order",status:"chargeback",description:""},35:{text:"kyc_is_required",status:"pause",description:"order_paused"},36:{text:"wrong_token",status:"fail",description:"order_not_completed"},37:{text:"kyc_is_required_email",status:"pause",description:"order_paused"},38:{text:"order_in_manual_mode",status:"pause",description:"order_paused"},39:{text:"requisites_need_to_be_changed",status:"pause",description:"order_paused"}},I=(e,t)=>{const r=e.reduce((s,n)=>{const o=t(n);return(s[o]=s[o]||[]).push(n),s},{});return Object.entries(r).map(([s,n])=>({field:s,items:n}))},D=e=>{var t,r;return{text:((t=g[e])==null?void 0:t.status)??"process",id:e,description:((r=g[e])==null?void 0:r.text)??""}},m=e=>e==="null"?null:e,O=e=>e.map(t=>{var i;const r="exchange",s=t.amount_money2,n=(i=t.money2)!=null&&i.includes("RUB")?"RUB":R(t.money2,t.money2_bcode),o=D(t.status),c=(t.date_make_order*1e3).toString();return t.req_money1=m(t.req_money1),t.req_money2=m(t.req_money2),{...t,amount:s,currency:n,type:r,status:o,date:c}});async function L(e=1,t={}){const r=new URLSearchParams({page:e,ordering:"-date_make_order",...t});console.log(r);const s=await p().get(`/user/orders?${r}`);return{items:I(O(s.results),o=>y(o.date_make_order*1e3).format("DD.MM.YYYY")),total:s.count}}const U=async e=>await a().get("/order/cancel/"+encodeURI(e)),x=async e=>await a().post("/order/create/",e),N=async e=>await a().get("/order/"+encodeURI(e)),P=async e=>await a().get("/order/start/check/"+encodeURI(e)),b=async(e,t)=>await a().post(`/order/send/code/${e}`,{code:t}),$=async(e,t)=>{const r=new FormData;return r.append("file",e),await a().post(`/order/send/check/${t}`,r,{headers:{"Content-Type":"multipart/form-data"}})},q=async(e,t)=>{const r=new FormData;return r.append("file",e),await a().post(`/order/send/image/upload/${t}`,r,{headers:{"Content-Type":"multipart/form-data"}})},k=(e=1)=>{},V=({email:e,password:t})=>a().post("/user/login",{email:e,password:t}),v=({username:e,password:t,password2:r,email:s,ref:n})=>a().post("/user/registration",{username:e,password:t,password2:r,email:s,ref:n}),G=e=>a().post("/user/refresh",{refresh:e}),H=e=>a().post("/user/get-token-reset-password",{email:e}),W=(e,t)=>a().post("/user/confirm-token-reset-password",{token:e,password:t}),F=()=>p().get("/user/retry-send-verif-email"),M=e=>a().get(`/user/activate/${e}`);function Y(e){const t="https://alfabit.org/api/v1",r=new URL(t).host;return A(`wss://${r}`,{path:e,transports:["websocket","polling"],reconnectionAttempts:3})}function B(){return Y("/stream/order/")}const Q=async(e="ru")=>await a().get(`/declaration?language=${e}`),X=async(e="ru")=>await a().get(`/privacy-policy?language=${e}`),K=async(e="ru")=>await a().get(`/cookies?language=${e}`),j=async(e="ru")=>await a().get(`/aml?language=${e}`),z=async(e="ru")=>await a().get(`/rules?language=${e}`),J=async()=>{try{return await a().get("/state")}catch{return!0}},Z=async()=>await a().get("/statistic"),ee=async()=>await a().get("/cashe/currencies-test/"),te=async e=>await a().get("/cashe/operations/"+encodeURI(e)),re=async()=>await a().get("/cashe/operations/"),se=async({request_amount:e,money_code:t,req_in:r})=>await p().post("/user/referal/request-out",{request_amount:e,money_code:t,req_in:r}),ae=async()=>await p().get("/user/referal/out"),ne=async(e=1)=>await p().get(`/user/referal/history?page=${e}`),oe=async()=>await p().get("/user/referal/stat"),ce=e=>u().get(`/vacancies?locale=${e}`),ie=e=>u().get(`/vacancies/${e}?populate[localizations][fields][0]=locale`),ue=e=>u().get(`/exchange-faq?locale=${e}&populate=*`).then(({data:{attributes:{faqs:{data:t}}}})=>t.map(r=>({id:r.id,...r.attributes}))),de=(e="ru")=>u().get(`/popular-questions-block?locale=${e}&populate=*`).then(({data:{attributes:{faqs:{data:t}}}})=>t.map(r=>({id:r.id,...r.attributes}))),pe=({product:e,locale:t,limit:r})=>{const s=new URLSearchParams({locale:t,populate:"product","filters[product][name][$eqi]":e});return r&&s.set("pagination[pageSize]",r),u().get(`/faqs?${s.toString()}`).then(({data:n})=>n.map(({id:o,attributes:{title:c,content:i}})=>({id:o,title:c,content:i})))},le=({product:e,locale:t})=>{let r={locale:t,populate:"product"};e&&(r={...r,"filters[product][name][$eqi]":e});const s=new URLSearchParams(r);return u().get(`/documents?${s.toString()}`).then(({data:n})=>n.map(({id:o,attributes:{slug:c,title:i,product:d}})=>({id:o,slug:c,title:i,product:d.name.toLowerCase()})))},_e=(e,t,r="ru")=>{const s=new URLSearchParams({populate:"product","filters[product][name][$eqi]":t,"filters[slug]":e,locale:r});return u().get(`/documents?${s.toString()}`).then(({data:n})=>n.map(({id:o,attributes:{title:c,content:i,updatedAt:d,slug:l}})=>({id:o,title:c,content:i,updatedAt:d,slug:l}))[0])},ge=async({locale:e,from:t,to:r})=>{const[s,n]=await Promise.allSettled([me({locale:e,code:t}).catch(()=>""),Ee({locale:e,code:r}).catch(()=>"")]).then(o=>o.map(({value:c})=>c));return{paymentTerms:s,receptionTerms:n}},me=({locale:e,code:t})=>{const r={locale:e,"filters[name][$eqi]":t},s=new URLSearchParams(r);return u().get(`/exchange-terms?${s.toString()}`).then(({data:n})=>n.map(({attributes:{payment_terms:o}})=>o)[0])},Ee=({locale:e,code:t})=>{const r={locale:e,"filters[name][$eqi]":t},s=new URLSearchParams(r);return u().get(`/exchange-terms?${s.toString()}`).then(({data:n})=>n.map(({attributes:{reception_terms:o}})=>o)[0])},Re=({locale:e})=>{const t={locale:e,populate:"slides,slides.media",sort:"createdAt:desc","pagination[start]":0,"pagination[limit]":1},r=new URLSearchParams(t);return u().get(`/newsletters?${r.toString()}`).then(({data:s})=>{if(!s[0])return null;const{attributes:{createdAt:n,slides:{data:o}}}=s[0];return{createdAt:n,slides:o.map(({attributes:{title:c,text:i,media:{data:d}}})=>{let l=null;return d&&(l={url:d.attributes.url,mime:d.attributes.mime}),{title:c,text:i,media:l}})}})},E={LAST_ORDERS:h,ALL_CURRENCIES:T,AVAILABLE_CURRENCIES:te,OPERATION_DETAILS:w,OPERATION_HISTORY:L,ORDER_DETAILS:N,ORDER_CANCEL:U,ORDER_CREATE:x,ORDER_PAYED:P,SEND_CODE:b,UPLOAD_CHEQUE:$,UPLOAD_CARD_VERIFICATION:q,ADD_REVIEW:S,REVIEW_EXISTS:f,DOCUMENTS:{DECLARATION:Q,COOKIE:K,PRIVACY:X,AML:j,RULES:z},SOCKETS:{ORDER_DETAILS:B},GET_USER_ORDERS:k,GET_REVIEWS:C,GET_STATE:J,AUTH:{LOGIN:V,REGISTER:v,REFRESH_TOKEN:G},CACHE:{AVAILABLE_DEALS:re,CURRENCIES:ee},REFERRALS:{REQUEST_WITHDRAW:se,WITHDRAW_DATA:ae,STATS:oe,DATA:ne},STATISTICS:Z,USER:{REQUEST_PASSWORD_CHANGE:H,CONFIRM_PASSWORD_CHANGE:W,RESEND_VERIFICATION_LINK:F,VERIFY_ACCOUNT:M},CMS:{VACANCIES:ce,VACANCY:ie,FAQ_BLOCK:ue,POPULAR_QUESTIONS_BLOCK:de,FAQS:pe,EXCHANGE:{DOCUMENT:(e,t)=>_e(e,_.EXCHANGE,t),DOCUMENTS:e=>le({locale:e,product:_.EXCHANGE})},EXCHANGE_TERMS:({locale:e,from:t,to:r})=>ge({locale:e,from:t,to:r}),NEWSLETTER:({locale:e})=>Re({locale:e})}},Ce={install(e){e.provide("api",E),e.config.globalProperties.$api=E}};export{Ce as a,E as b};
